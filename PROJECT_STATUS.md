# TRPGアプリ開発状況 - 2025年8月30日

## プロジェクト概要
クトゥルフ神話TRPG用のキャラクター管理・履歴追跡特化アプリ
- **目的**: いあきゃら補完の履歴管理・バックアップ特化アプリ
- **対象**: 65体以上のキャラクターを管理するヘビーユーザー向け
- **技術スタック**: Next.js 15, TypeScript, Prisma, Neon PostgreSQL, Vercel

## 最新デプロイURL
https://trpg-m4lvuxy0n-tsukis-projects-5248bf54.vercel.app

## 今日完了した作業

### 1. キャラクターメモ機能追加
- キャラクター詳細画面の概要タブにメモ欄を追加
- 編集・保存・キャンセル機能付き
- データベースにメモフィールド追加（migration実行済み）

### 2. 技能成長の手動入力機能
- 従来の自動1d10から手動入力方式に変更
- 成長値入力モーダル実装（プレビュー機能付き）
- Enter確定・Escape取消のキーボード操作対応

### 3. UI改善
- SAN値減少理由の入力フィールドを削除
- MOV表示を削除（キャラクター詳細画面）
- グリッドレイアウト調整（4列→3列）

### 4. 知識・アイデア追加
- キャラクター詳細画面に知識（EDU×5）、アイデア（INT×5）を追加
- 新規作成画面でも自動計算表示
- 6版ルール説明文も更新

### 5. 技能初期値修正
- 6版ルールブック準拠の正しい初期値に修正
- 主要な修正: こぶし25%→50%, 登攀20%→40%, 聞き耳20%→25%等
- 技能名の日本語表記も一部修正

### 6. いあきゃらインポート改善
- 技能値パース処理の改善（複数フォーマット対応）
- 【メモ】セクションの正確な取得
- インポートプレビューでメモ表示
- 技能名マッピング拡張

## 現在の主要機能

### キャラクター管理
- ✅ 新規キャラクター作成（6版準拠）
- ✅ いあきゃらからのインポート
- ✅ キャラクター一覧（65体対応の効率的UI）
- ✅ キャラクター詳細表示
- ✅ キャラクター編集・削除
- ✅ キャラクターメモ機能

### セッション管理
- ✅ セッション記録作成
- ✅ 技能成長記録（手動入力）
- ✅ SAN値変動記録
- ✅ 狂気症状記録
- ✅ セッション履歴表示
- ✅ セッション個別削除

### 計算・表示機能
- ✅ 6版準拠の副能力値自動計算
- ✅ 知識（EDU×5）・アイデア（INT×5）表示
- ✅ 幸運（POW×5）自動計算
- ✅ 正確な技能初期値設定

## ファイル構成

### 主要コンポーネント
- `src/app/page.tsx` - キャラクター一覧（65体対応UI）
- `src/app/characters/new/page.tsx` - 新規作成画面
- `src/app/characters/[id]/page.tsx` - キャラクター詳細画面
- `src/app/characters/[id]/session/page.tsx` - セッション記録画面
- `src/app/import/page.tsx` - いあきゃらインポート画面
- `src/components/Navigation.tsx` - ナビゲーションコンポーネント

### データ処理
- `src/lib/cthulhu-utils.ts` - 6版ルール計算関数・技能初期値
- `src/lib/iakyara-parser.ts` - いあきゃらテキストパーサー
- `src/lib/skill-names.ts` - 技能名日本語マッピング
- `src/types/cthulhu.ts` - 型定義

### API
- `src/app/api/characters/route.ts` - キャラクター一覧・作成
- `src/app/api/characters/[id]/route.ts` - 個別操作
- `src/app/api/characters/[id]/sessions/route.ts` - セッション記録
- `src/app/api/sessions/[id]/route.ts` - セッション削除

### データベース
- `prisma/schema.prisma` - データベーススキーマ
- PostgreSQL (Neon) 使用

## 今後の改善案

### 優先度高
- [ ] セッション記録時のより詳細な情報入力
- [ ] キャラクター画像アップロード機能の改善
- [ ] 技能成長履歴の可視化
- [ ] バックアップ・エクスポート機能

### 優先度中
- [ ] キャラクター複製機能
- [ ] セッション統計・分析機能
- [ ] 検索・フィルター機能の拡張
- [ ] ダークモードの完全対応

### 優先度低
- [ ] 他のTRPGシステム対応
- [ ] モバイルアプリ化
- [ ] 多人数での共有機能

## 技術的注意点

### デプロイ
- Vercel自動デプロイ設定済み
- 変更のたびにデプロイが実行される
- `vercel --prod` で手動デプロイ可能

### データベース
- Neon PostgreSQL使用
- Prisma ORMでスキーマ管理
- migration実行済み（memoフィールド追加）

### 環境変数
- `POSTGRES_PRISMA_URL` - DB接続URL
- Vercelプロジェクトで設定済み

## 開発再開時のチェックリスト
1. ローカル環境でのdev server起動確認 (`npm run dev`)
2. 最新のデプロイURL動作確認
3. 新機能のテスト実行
4. 未解決の課題があれば GitHub Issues で確認
5. TodoWrite機能を使ったタスク管理の継続

## 連絡先・リソース
- リポジトリ: https://github.com/oyuduki-web/trpg-app
- デプロイ: Vercel (tsukis-projects-5248bf54)
- データベース: Neon PostgreSQL

---
**更新日**: 2025年8月30日
**次回作業予定**: 未定